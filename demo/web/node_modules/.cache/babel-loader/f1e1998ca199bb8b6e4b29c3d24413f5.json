{"ast":null,"code":"import _slicedToArray from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useContext}from'react';import{useLocation}from'wouter';import{rpUserContext}from'../../../context/rp-user/RPUser';export function RPPermissionGuard(_ref){var _rpUser$rank,_rpUser$rank$permissi;var children=_ref.children,permission=_ref.permission,_ref$redirect=_ref.redirect,redirect=_ref$redirect===void 0?true:_ref$redirect;var _useLocation=useLocation(),_useLocation2=_slicedToArray(_useLocation,2),location=_useLocation2[0],setLocation=_useLocation2[1];var _useContext=useContext(rpUserContext),rpUser=_useContext.rpUser;var hasPermission=!!(rpUser===null||rpUser===void 0?void 0:(_rpUser$rank=rpUser.rank)===null||_rpUser$rank===void 0?void 0:(_rpUser$rank$permissi=_rpUser$rank.permissions)===null||_rpUser$rank$permissi===void 0?void 0:_rpUser$rank$permissi[permission]);if(!hasPermission){if(redirect){setLocation(rpUser?'/me':'/login');}return null;}return children;}","map":{"version":3,"sources":["/Users/chris/Projects/instinct/packages/@instinct-theme/roleplay/src/components/templates/permission-guard/PermissionGuard.tsx"],"names":["useContext","useLocation","rpUserContext","RPPermissionGuard","children","permission","redirect","location","setLocation","rpUser","hasPermission","rank","permissions"],"mappings":"qJAAA,OAAQA,UAAR,KAAyB,OAAzB,CACA,OAAQC,WAAR,KAA0B,QAA1B,CACA,OAAQC,aAAR,KAA4B,iCAA5B,CAGA,MAAO,SAASC,CAAAA,iBAAT,MAIoB,2CAHzBC,CAAAA,QAGyB,MAHzBA,QAGyB,CAFzBC,UAEyB,MAFzBA,UAEyB,oBADzBC,QACyB,CADzBA,QACyB,wBADd,IACc,eACzB,iBAAgCL,WAAW,EAA3C,8CAAOM,QAAP,kBAAiBC,WAAjB,kBACA,gBAAiBR,UAAU,CAACE,aAAD,CAA3B,CAAOO,MAAP,aAAOA,MAAP,CACA,GAAMC,CAAAA,aAAa,CAAG,CAAC,EAACD,MAAD,SAACA,MAAD,+BAACA,MAAM,CAAEE,IAAT,8DAAC,aAAcC,WAAf,gDAAC,sBAA4BP,UAA5B,CAAD,CAAvB,CAEA,GAAI,CAACK,aAAL,CAAoB,CAClB,GAAIJ,QAAJ,CAAc,CACZE,WAAW,CAACC,MAAM,CAAG,KAAH,CAAW,QAAlB,CAAX,CACD,CAED,MAAO,KAAP,CACD,CAED,MAAOL,CAAAA,QAAP,CACD","sourcesContent":["import {useContext} from 'react';\nimport {useLocation} from 'wouter';\nimport {rpUserContext} from '../../../context/rp-user/RPUser';\nimport {RPPermissionGuardProps} from './PermissionGuard.types';\n\nexport function RPPermissionGuard({\n  children,\n  permission,\n  redirect = true,\n}: RPPermissionGuardProps) {\n  const [location, setLocation] = useLocation();\n  const {rpUser} = useContext(rpUserContext);\n  const hasPermission = !!rpUser?.rank?.permissions?.[permission];\n\n  if (!hasPermission) {\n    if (redirect) {\n      setLocation(rpUser ? '/me' : '/login');\n    }\n\n    return null;\n  }\n\n  return children;\n}\n"]},"metadata":{},"sourceType":"module"}