{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Router}from'../router';import{DataPolling}from'../data-polling';import{ToastContainer}from'react-toastify';import{BannedGuard}from'../../guard/banned';import{useBanListener}from'../../../hooks/user';import{SkeletonTheme}from'react-loading-skeleton';import{configContext}from'../../../context/config';import{healthContext}from'../../../context/health';import{configService}from'../../../services/config';import{sessionContext}from'../../../context/session';import{sessionService}from'../../../services/session';import{RenderError}from'../../generic/error/RenderError';import React,{useContext,useEffect,useState}from'react';import{StripeProvider}from'../stripe-provider/StripeProvider';import{ServerMaintenanceGuard}from'../../guard/server-maintenance';import{Icon}from'../../generic/icon';export function Bootstrap(){useBanListener();var _useState=useState(false),_useState2=_slicedToArray(_useState,2),ready=_useState2[0],setReady=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),failedToLaunch=_useState4[0],setFailedToLaunch=_useState4[1];var _useContext=useContext(configContext),setConfig=_useContext.setConfig;var _useContext2=useContext(healthContext),setHealth=_useContext2.setHealth;var _useContext3=useContext(sessionContext),setUser=_useContext3.setUser;useEffect(function(){function init(){return _init.apply(this,arguments);}function _init(){_init=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$Promise$all,_yield$Promise$all2,user,config,health;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return Promise.all([sessionService.init(),configService.getConfig(),configService.getHealth()]);case 3:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,3);user=_yield$Promise$all2[0];config=_yield$Promise$all2[1];health=_yield$Promise$all2[2];setUser(user);setConfig(config);setHealth(health);setReady(true);_context.next=18;break;case 14:_context.prev=14;_context.t0=_context[\"catch\"](0);setReady(true);setFailedToLaunch(true);case 18:case\"end\":return _context.stop();}}},_callee,null,[[0,14]]);}));return _init.apply(this,arguments);}init();},[]);if(!ready){return/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-spin fa-spinner\"});}if(failedToLaunch){return/*#__PURE__*/React.createElement(\"div\",{className:\"text-center\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"text-danger text-uppercase\",style:{marginTop:'15%'}},/*#__PURE__*/React.createElement(Icon,{type:\"exclamation-triangle\"}),\"Failed to Launch\"),/*#__PURE__*/React.createElement(\"h4\",null,\"There was a problem. Please try again later.\"));}try{return/*#__PURE__*/React.createElement(React.StrictMode,null,/*#__PURE__*/React.createElement(SkeletonTheme,{color:\"#0f416d\",highlightColor:\"#1a4d6e\"},/*#__PURE__*/React.createElement(ToastContainer,null),/*#__PURE__*/React.createElement(ServerMaintenanceGuard,null,/*#__PURE__*/React.createElement(BannedGuard,null,/*#__PURE__*/React.createElement(StripeProvider,null,/*#__PURE__*/React.createElement(\"div\",{style:{position:'absolute',top:0,left:0,minHeight:'100%',minWidth:'100%'}},/*#__PURE__*/React.createElement(Router,null),/*#__PURE__*/React.createElement(DataPolling,null)))))));}catch(_unused2){return/*#__PURE__*/React.createElement(RenderError,null);}}","map":{"version":3,"sources":["/Users/chris/Projects/instinct/packages/@instinct-web/core/src/components/utility/bootstrap/Bootstrap.tsx"],"names":["Router","DataPolling","ToastContainer","BannedGuard","useBanListener","SkeletonTheme","configContext","healthContext","configService","sessionContext","sessionService","RenderError","React","useContext","useEffect","useState","StripeProvider","ServerMaintenanceGuard","Icon","Bootstrap","ready","setReady","failedToLaunch","setFailedToLaunch","setConfig","setHealth","setUser","init","Promise","all","getConfig","getHealth","user","config","health","marginTop","position","top","left","minHeight","minWidth"],"mappings":"4bAAA,OAAQA,MAAR,KAAqB,WAArB,CACA,OAAQC,WAAR,KAA0B,iBAA1B,CACA,OAAQC,cAAR,KAA6B,gBAA7B,CACA,OAAQC,WAAR,KAA0B,oBAA1B,CACA,OAAQC,cAAR,KAA6B,qBAA7B,CACA,OAAQC,aAAR,KAA4B,wBAA5B,CACA,OAAQC,aAAR,KAA4B,yBAA5B,CACA,OAAQC,aAAR,KAA4B,yBAA5B,CACA,OAAQC,aAAR,KAA4B,0BAA5B,CACA,OAAQC,cAAR,KAA6B,0BAA7B,CACA,OAAQC,cAAR,KAA6B,2BAA7B,CACA,OAAQC,WAAR,KAA0B,iCAA1B,CACA,MAAOC,CAAAA,KAAP,EAAeC,UAAf,CAA2BC,SAA3B,CAAsCC,QAAtC,KAAqD,OAArD,CACA,OAAQC,cAAR,KAA6B,mCAA7B,CACA,OAAQC,sBAAR,KAAqC,gCAArC,CACA,OAAQC,IAAR,KAAmB,oBAAnB,CAEA,MAAO,SAASC,CAAAA,SAAT,EAAqB,CAC1Bf,cAAc,GACd,cAA0BW,QAAQ,CAAC,KAAD,CAAlC,wCAAOK,KAAP,eAAcC,QAAd,eACA,eAA4CN,QAAQ,CAAC,KAAD,CAApD,yCAAOO,cAAP,eAAuBC,iBAAvB,eACA,gBAAoBV,UAAU,CAACP,aAAD,CAA9B,CAAOkB,SAAP,aAAOA,SAAP,CACA,iBAAoBX,UAAU,CAACN,aAAD,CAA9B,CAAOkB,SAAP,cAAOA,SAAP,CACA,iBAAkBZ,UAAU,CAACJ,cAAD,CAA5B,CAAOiB,OAAP,cAAOA,OAAP,CAEAZ,SAAS,CAAC,UAAM,SACCa,CAAAA,IADD,sHACd,uOAEyCC,CAAAA,OAAO,CAACC,GAAR,CAAY,CAC/CnB,cAAc,CAACiB,IAAf,EAD+C,CAE/CnB,aAAa,CAACsB,SAAd,EAF+C,CAG/CtB,aAAa,CAACuB,SAAd,EAH+C,CAAZ,CAFzC,kGAEWC,IAFX,wBAEiBC,MAFjB,wBAEyBC,MAFzB,wBAQIR,OAAO,CAACM,IAAD,CAAP,CACAR,SAAS,CAACS,MAAD,CAAT,CACAR,SAAS,CAACS,MAAD,CAAT,CACAb,QAAQ,CAAC,IAAD,CAAR,CAXJ,iFAaIA,QAAQ,CAAC,IAAD,CAAR,CACAE,iBAAiB,CAAC,IAAD,CAAjB,CAdJ,qEADc,uCAmBdI,IAAI,GACL,CApBQ,CAoBN,EApBM,CAAT,CAsBA,GAAI,CAACP,KAAL,CAAY,CACV,mBAAO,yBAAG,SAAS,CAAC,uBAAb,EAAP,CACD,CAED,GAAIE,cAAJ,CAAoB,CAClB,mBACE,2BAAK,SAAS,CAAC,aAAf,eACE,0BAAI,SAAS,CAAC,4BAAd,CAA2C,KAAK,CAAE,CAACa,SAAS,CAAE,KAAZ,CAAlD,eACE,oBAAC,IAAD,EAAM,IAAI,CAAC,sBAAX,EADF,oBADF,cAKE,6EALF,CADF,CASD,CAED,GAAI,CACF,mBACE,oBAAC,KAAD,CAAO,UAAP,mBACE,oBAAC,aAAD,EAAe,KAAK,CAAC,SAArB,CAA+B,cAAc,CAAC,SAA9C,eACE,oBAAC,cAAD,MADF,cAEE,oBAAC,sBAAD,mBACE,oBAAC,WAAD,mBACE,oBAAC,cAAD,mBACE,2BACE,KAAK,CAAE,CACLC,QAAQ,CAAE,UADL,CAELC,GAAG,CAAE,CAFA,CAGLC,IAAI,CAAE,CAHD,CAILC,SAAS,CAAE,MAJN,CAKLC,QAAQ,CAAE,MALL,CADT,eASE,oBAAC,MAAD,MATF,cAUE,oBAAC,WAAD,MAVF,CADF,CADF,CADF,CAFF,CADF,CADF,CAyBD,CAAC,eAAM,CACN,mBAAO,oBAAC,WAAD,MAAP,CACD,CACF","sourcesContent":["import {Router} from '../router';\nimport {DataPolling} from '../data-polling';\nimport {ToastContainer} from 'react-toastify';\nimport {BannedGuard} from '../../guard/banned';\nimport {useBanListener} from '../../../hooks/user';\nimport {SkeletonTheme} from 'react-loading-skeleton';\nimport {configContext} from '../../../context/config';\nimport {healthContext} from '../../../context/health';\nimport {configService} from '../../../services/config';\nimport {sessionContext} from '../../../context/session';\nimport {sessionService} from '../../../services/session';\nimport {RenderError} from '../../generic/error/RenderError';\nimport React, {useContext, useEffect, useState} from 'react';\nimport {StripeProvider} from '../stripe-provider/StripeProvider';\nimport {ServerMaintenanceGuard} from '../../guard/server-maintenance';\nimport {Icon} from '../../generic/icon';\n\nexport function Bootstrap() {\n  useBanListener();\n  const [ready, setReady] = useState(false);\n  const [failedToLaunch, setFailedToLaunch] = useState(false);\n  const {setConfig} = useContext(configContext);\n  const {setHealth} = useContext(healthContext);\n  const {setUser} = useContext(sessionContext);\n\n  useEffect(() => {\n    async function init() {\n      try {\n        const [user, config, health] = await Promise.all([\n          sessionService.init(),\n          configService.getConfig(),\n          configService.getHealth(),\n        ]);\n\n        setUser(user);\n        setConfig(config);\n        setHealth(health);\n        setReady(true);\n      } catch {\n        setReady(true);\n        setFailedToLaunch(true);\n      }\n    }\n\n    init();\n  }, []);\n\n  if (!ready) {\n    return <i className=\"fa fa-spin fa-spinner\" />;\n  }\n\n  if (failedToLaunch) {\n    return (\n      <div className=\"text-center\">\n        <h2 className=\"text-danger text-uppercase\" style={{marginTop: '15%'}}>\n          <Icon type=\"exclamation-triangle\" />\n          Failed to Launch\n        </h2>\n        <h4>There was a problem. Please try again later.</h4>\n      </div>\n    );\n  }\n\n  try {\n    return (\n      <React.StrictMode>\n        <SkeletonTheme color=\"#0f416d\" highlightColor=\"#1a4d6e\">\n          <ToastContainer />\n          <ServerMaintenanceGuard>\n            <BannedGuard>\n              <StripeProvider>\n                <div\n                  style={{\n                    position: 'absolute',\n                    top: 0,\n                    left: 0,\n                    minHeight: '100%',\n                    minWidth: '100%',\n                  }}\n                >\n                  <Router />\n                  <DataPolling />\n                </div>\n              </StripeProvider>\n            </BannedGuard>\n          </ServerMaintenanceGuard>\n        </SkeletonTheme>\n      </React.StrictMode>\n    );\n  } catch {\n    return <RenderError />;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}