{"ast":null,"code":"import _slicedToArray from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./ViewArticle.scss';import Moment from'moment';import React,{useState}from'react';import{Link,useRoute}from'wouter';import ReactMarkdown from'react-markdown';import{ViewComments}from'./view-comments/ViewComments';import{Row}from'../../../../components/generic/row/Row';import{Card}from'../../../../components/generic/card/Card';import{UserLayout}from'../../../../components/layout/user/UserLayout';import{Container}from'../../../../components/generic/container/Container';import{Avatar,setURL,useFetchArticleByID,Icon}from'@instinct-web/core';import{MiniJumbotron}from'../../../../components/generic/mini-jumbotron/MiniJumbotron';import{useFetchArticleByUser}from'@instinct-web/core/src/hooks/article/fetch-article-by-user';setURL('community/news/:articleID',/*#__PURE__*/React.createElement(ViewArticle,null));export function ViewArticle(){var _article$author,_articlesByAuthor$fil;var _useRoute=useRoute('/community/news/:articleID'),_useRoute2=_slicedToArray(_useRoute,2),match=_useRoute2[0],params=_useRoute2[1];var _useState=useState(0),_useState2=_slicedToArray(_useState,2),refresh=_useState2[0],setRefresh=_useState2[1];function refreshArticle(){setRefresh(function(_){return _+1;});}var article=useFetchArticleByID(params.articleID,refresh);var articlesByAuthor=useFetchArticleByUser(article===null||article===void 0?void 0:(_article$author=article.author)===null||_article$author===void 0?void 0:_article$author.id);var otherArticlesByAuthor=(_articlesByAuthor$fil=articlesByAuthor===null||articlesByAuthor===void 0?void 0:articlesByAuthor.filter(function(_){return _.id!==(article===null||article===void 0?void 0:article.id);}))!==null&&_articlesByAuthor$fil!==void 0?_articlesByAuthor$fil:[];if(!article){return/*#__PURE__*/React.createElement(UserLayout,{section:\"article\"},/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(Link,{to:\"/community/news\"},/*#__PURE__*/React.createElement(\"div\",{style:{cursor:'pointer',color:'white'}},/*#__PURE__*/React.createElement(Icon,{className:\"fa-4x\",type:\"caret-left\"}))))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(Icon,{type:\"spinner fa-spin fa-3x\"})))));}return/*#__PURE__*/React.createElement(UserLayout,{section:\"article\"},/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Row,{className:\"mb-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(Link,{to:\"/community/news\"},/*#__PURE__*/React.createElement(\"div\",{style:{cursor:'pointer',color:'white'}},/*#__PURE__*/React.createElement(Icon,{className:\"fa-4x\",type:\"caret-left\"}))))),/*#__PURE__*/React.createElement(Row,{className:\"mb-4\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(MiniJumbotron,{className:\"text-center mb-0\",style:{backgroundImage:\"url(\".concat(article.headerImage),backgroundSize:'cover',borderBottomLeftRadius:0,borderBottomRightRadius:0,height:180}},/*#__PURE__*/React.createElement(\"h2\",null,article.title),/*#__PURE__*/React.createElement(\"h4\",null,article.description),/*#__PURE__*/React.createElement(\"div\",{className:\"w-50\",style:{margin:'0 auto'}},/*#__PURE__*/React.createElement(\"hr\",null),/*#__PURE__*/React.createElement(\"p\",null,\"Posted on\",' ',/*#__PURE__*/React.createElement(\"b\",null,Moment.unix(article.datePosted).format('MMM DD, YYYY'))))))),/*#__PURE__*/React.createElement(Row,{className:\"mb-2\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-8\"},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(ReactMarkdown,null,article.content))),/*#__PURE__*/React.createElement(\"div\",{className:\"col-4\"},/*#__PURE__*/React.createElement(Card,{header:\"About the Author\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"avatar\",style:{marginLeft:-20}},/*#__PURE__*/React.createElement(Avatar,{look:article.author.figure,direction:2,gesture:\"sml\",size:\"l\"})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Link,{to:\"/profile/\".concat(article.author.username)},/*#__PURE__*/React.createElement(\"h4\",null,article.author.username)),/*#__PURE__*/React.createElement(\"div\",{className:\"badge badge-primary\"},article.author.rank.name)))),/*#__PURE__*/React.createElement(Card,{header:\"Other Articles by the Author\"},articlesByAuthor?/*#__PURE__*/React.createElement(\"div\",{className:\"related-articles-container\",style:{maxHeight:200,overflowY:'scroll'}},otherArticlesByAuthor.map(function(_){return/*#__PURE__*/React.createElement(Link,{className:\"related-article-container\",key:\"article_\".concat(_.id),to:\"/community/news/\".concat(_.id)},/*#__PURE__*/React.createElement(\"div\",{className:\"related-article-thumbnail\",style:{backgroundImage:\"url(\".concat(_.thumbnailImage,\")\")}}),/*#__PURE__*/React.createElement(\"div\",{className:\"related-article-details\"},/*#__PURE__*/React.createElement(\"div\",{className:\"related-article-title\"},_.title),/*#__PURE__*/React.createElement(\"div\",{className:\"related-article-date\"},Moment.unix(_.datePosted).format('MMM DD, YYYY'))));}),otherArticlesByAuthor.length===0&&/*#__PURE__*/React.createElement(\"p\",null,article.author.username,\" hasn't posted more articles\")):/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Icon,{type:\"spinner fa-spin\"}),\" Loading...\")),/*#__PURE__*/React.createElement(ViewComments,{article:article,onChange:refreshArticle})))));}","map":{"version":3,"sources":["/Users/chris/Projects/instinct/packages/@instinct-theme/roleplay/src/pages/community/news/view-article/ViewArticle.tsx"],"names":["Moment","React","useState","Link","useRoute","ReactMarkdown","ViewComments","Row","Card","UserLayout","Container","Avatar","setURL","useFetchArticleByID","Icon","MiniJumbotron","useFetchArticleByUser","ViewArticle","match","params","refresh","setRefresh","refreshArticle","_","article","articleID","articlesByAuthor","author","id","otherArticlesByAuthor","filter","cursor","color","backgroundImage","headerImage","backgroundSize","borderBottomLeftRadius","borderBottomRightRadius","height","title","description","margin","unix","datePosted","format","content","marginLeft","figure","username","rank","name","maxHeight","overflowY","map","thumbnailImage","length"],"mappings":"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","sourcesContent":["import './ViewArticle.scss';\nimport Moment from 'moment';\nimport React, {useState} from 'react';\nimport {Link, useRoute} from 'wouter';\nimport ReactMarkdown from 'react-markdown';\nimport {ViewComments} from './view-comments/ViewComments';\nimport {Row} from '../../../../components/generic/row/Row';\nimport {Card} from '../../../../components/generic/card/Card';\nimport {UserLayout} from '../../../../components/layout/user/UserLayout';\nimport {Container} from '../../../../components/generic/container/Container';\nimport {Avatar, setURL, useFetchArticleByID, Icon} from '@instinct-web/core';\nimport {MiniJumbotron} from '../../../../components/generic/mini-jumbotron/MiniJumbotron';\nimport {useFetchArticleByUser} from '@instinct-web/core/src/hooks/article/fetch-article-by-user';\n\nsetURL('community/news/:articleID', <ViewArticle />);\n\nexport function ViewArticle() {\n  const [match, params] = useRoute<{articleID: string}>(\n    '/community/news/:articleID'\n  );\n  const [refresh, setRefresh] = useState(0);\n\n  function refreshArticle() {\n    setRefresh(_ => _ + 1);\n  }\n\n  const article = useFetchArticleByID(params!.articleID, refresh);\n  const articlesByAuthor = useFetchArticleByUser(article?.author?.id);\n  const otherArticlesByAuthor =\n    articlesByAuthor?.filter(_ => _.id !== article?.id) ?? [];\n\n  if (!article) {\n    return (\n      <UserLayout section=\"article\">\n        <Container>\n          <Row>\n            <div className=\"col-12\">\n              <Link to=\"/community/news\">\n                <div style={{cursor: 'pointer', color: 'white'}}>\n                  <Icon className=\"fa-4x\" type=\"caret-left\" />\n                </div>\n              </Link>\n            </div>\n          </Row>\n          <Row>\n            <div className=\"col-12\">\n              <Icon type=\"spinner fa-spin fa-3x\" />\n            </div>\n          </Row>\n        </Container>\n      </UserLayout>\n    );\n  }\n\n  return (\n    <UserLayout section=\"article\">\n      <Container>\n        <Row className=\"mb-2\">\n          <div className=\"col-12\">\n            <Link to=\"/community/news\">\n              <div style={{cursor: 'pointer', color: 'white'}}>\n                <Icon className=\"fa-4x\" type=\"caret-left\" />\n              </div>\n            </Link>\n          </div>\n        </Row>\n        <Row className=\"mb-4\">\n          <div className=\"col-12\">\n            <MiniJumbotron\n              className=\"text-center mb-0\"\n              style={{\n                backgroundImage: `url(${article.headerImage}`,\n                backgroundSize: 'cover',\n                borderBottomLeftRadius: 0,\n                borderBottomRightRadius: 0,\n                height: 180,\n              }}\n            >\n              <h2>{article.title}</h2>\n              <h4>{article.description}</h4>\n              <div className=\"w-50\" style={{margin: '0 auto'}}>\n                <hr />\n                <p>\n                  Posted on{' '}\n                  <b>\n                    {Moment.unix(article.datePosted).format('MMM DD, YYYY')}\n                  </b>\n                </p>\n              </div>\n            </MiniJumbotron>\n          </div>\n        </Row>\n        <Row className=\"mb-2\">\n          <div className=\"col-8\">\n            <Card>\n              <ReactMarkdown>{article.content}</ReactMarkdown>\n            </Card>\n          </div>\n          <div className=\"col-4\">\n            <Card header=\"About the Author\">\n              <Row>\n                <div className=\"avatar\" style={{marginLeft: -20}}>\n                  <Avatar\n                    look={article.author.figure}\n                    direction={2}\n                    gesture=\"sml\"\n                    size=\"l\"\n                  />\n                </div>\n                <div>\n                  <Link to={`/profile/${article.author.username}`}>\n                    <h4>{article.author.username}</h4>\n                  </Link>\n                  <div className=\"badge badge-primary\">\n                    {article.author.rank!.name}\n                  </div>\n                </div>\n              </Row>\n            </Card>\n            <Card header=\"Other Articles by the Author\">\n              {articlesByAuthor ? (\n                <div\n                  className=\"related-articles-container\"\n                  style={{maxHeight: 200, overflowY: 'scroll'}}\n                >\n                  {otherArticlesByAuthor.map(_ => (\n                    <Link\n                      className=\"related-article-container\"\n                      key={`article_${_.id}`}\n                      to={`/community/news/${_.id}`}\n                    >\n                      <div\n                        className=\"related-article-thumbnail\"\n                        style={{backgroundImage: `url(${_.thumbnailImage})`}}\n                      />\n                      <div className=\"related-article-details\">\n                        <div className=\"related-article-title\">{_.title}</div>\n                        <div className=\"related-article-date\">\n                          {Moment.unix(_.datePosted).format('MMM DD, YYYY')}\n                        </div>\n                      </div>\n                    </Link>\n                  ))}\n                  {otherArticlesByAuthor.length === 0 && (\n                    <p>{article.author.username} hasn't posted more articles</p>\n                  )}\n                </div>\n              ) : (\n                <>\n                  <Icon type=\"spinner fa-spin\" /> Loading...\n                </>\n              )}\n            </Card>\n            <ViewComments article={article} onChange={refreshArticle} />\n          </div>\n        </Row>\n      </Container>\n    </UserLayout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}