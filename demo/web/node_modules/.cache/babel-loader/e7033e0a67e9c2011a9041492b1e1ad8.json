{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React from'react';import{toast}from'react-toastify';import{Link,useRoute}from'wouter';import{setURL,Icon}from'@instinct-web/core';import{Row}from'../../components/generic/row/Row';import{BusinessEditor}from'./editor/BusinessEditor';import{UserLayout}from'../../components/layout/user';import{businessService}from'../../services/business';import{useFetchBusinessByID}from'../../hooks/business';import{Container}from'../../components/generic/container/Container';import{RPPermissionGuard}from'../../components/templates/permission-guard';import{MiniJumbotron}from'../../components/generic/mini-jumbotron/MiniJumbotron';setURL('businesses/edit/:businessID',/*#__PURE__*/React.createElement(BusinessEdit,null));export function BusinessEdit(){var _useRoute=useRoute('/businesses/edit/:businessID'),_useRoute2=_slicedToArray(_useRoute,2),matched=_useRoute2[0],params=_useRoute2[1];var business=useFetchBusinessByID(params.businessID);if(!business){return/*#__PURE__*/React.createElement(UserLayout,{section:\"business\"},/*#__PURE__*/React.createElement(RPPermissionGuard,{permission:\"websiteCreateBusiness\"},/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(Icon,{type:\"spinner fa-spin fa-3x\"}),/*#__PURE__*/React.createElement(\"h2\",null,\"Loading Business\"))))));}var businessDTO={name:business.name,desc:business.desc,type:business.type,badge:business.badge,homeRoom:business.homeRoomID,investment:0,positions:business.positions.map(function(businessPosition){return{id:businessPosition.id,order:businessPosition.order,name:businessPosition.name,maleUniform:businessPosition.maleUniform,femaleUniform:businessPosition.femaleUniform,shiftWage:businessPosition.shiftWage};})};function onSubmit(_x){return _onSubmit.apply(this,arguments);}function _onSubmit(){_onSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(newBusinessDTO){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return businessService.delete(business.id.toString());case 3:toast.success(\"Your changes to \".concat(newBusinessDTO.name,\" were saved successfully\"));_context.next=9;break;case 6:_context.prev=6;_context.t0=_context[\"catch\"](0);toast.error(\"There was a problem when saving your changes to \".concat(business.name));case 9:case\"end\":return _context.stop();}}},_callee,null,[[0,6]]);}));return _onSubmit.apply(this,arguments);}return/*#__PURE__*/React.createElement(UserLayout,{section:\"business\"},/*#__PURE__*/React.createElement(RPPermissionGuard,{permission:\"websiteCreateBusiness\"},/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(Link,{to:\"/businesses\"},/*#__PURE__*/React.createElement(Icon,{className:\"fa-4x text-white\",style:{cursor:'pointer'},type:\"caret-left\"})))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(MiniJumbotron,null,/*#__PURE__*/React.createElement(\"h2\",null,\"Business Editor\"),/*#__PURE__*/React.createElement(\"p\",null,\"You are making changes to \",/*#__PURE__*/React.createElement(\"b\",null,business.name)))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{style:{width:'100%'}},/*#__PURE__*/React.createElement(BusinessEditor,{defaultBusiness:businessDTO,onSubmit:onSubmit}))))));}","map":{"version":3,"sources":["/Users/chris/Projects/instinct/packages/@instinct-theme/roleplay/src/pages/business/BusinessEdit.tsx"],"names":["React","toast","Link","useRoute","setURL","Icon","Row","BusinessEditor","UserLayout","businessService","useFetchBusinessByID","Container","RPPermissionGuard","MiniJumbotron","BusinessEdit","matched","params","business","businessID","businessDTO","name","desc","type","badge","homeRoom","homeRoomID","investment","positions","map","businessPosition","id","order","maleUniform","femaleUniform","shiftWage","onSubmit","newBusinessDTO","delete","toString","success","error","cursor","width"],"mappings":"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","sourcesContent":["import React from 'react';\nimport {toast} from 'react-toastify';\nimport {Link, useRoute} from 'wouter';\nimport {setURL, Icon} from '@instinct-web/core';\nimport {Row} from '../../components/generic/row/Row';\nimport {BusinessEditor} from './editor/BusinessEditor';\nimport {UserLayout} from '../../components/layout/user';\nimport {businessService} from '../../services/business';\nimport {useFetchBusinessByID} from '../../hooks/business';\nimport {BusinessDTO} from '@instinct-plugin/roleplay-types';\nimport {Container} from '../../components/generic/container/Container';\nimport {RPPermissionGuard} from '../../components/templates/permission-guard';\nimport {MiniJumbotron} from '../../components/generic/mini-jumbotron/MiniJumbotron';\n\nsetURL('businesses/edit/:businessID', <BusinessEdit />);\n\nexport function BusinessEdit() {\n  const [matched, params] = useRoute<{businessID: string}>(\n    '/businesses/edit/:businessID'\n  );\n\n  const business = useFetchBusinessByID(params!.businessID);\n\n  if (!business) {\n    return (\n      <UserLayout section=\"business\">\n        <RPPermissionGuard permission=\"websiteCreateBusiness\">\n          <Container>\n            <Row>\n              <div className=\"col-12\">\n                <Icon type=\"spinner fa-spin fa-3x\" />\n                <h2>Loading Business</h2>\n              </div>\n            </Row>\n          </Container>\n        </RPPermissionGuard>\n      </UserLayout>\n    );\n  }\n\n  const businessDTO: BusinessDTO = {\n    name: business.name,\n    desc: business.desc,\n    type: business.type,\n    badge: business.badge,\n    homeRoom: business.homeRoomID,\n    investment: 0,\n    positions: business.positions.map(businessPosition => ({\n      id: businessPosition.id,\n      order: businessPosition.order,\n      name: businessPosition.name,\n      maleUniform: businessPosition.maleUniform,\n      femaleUniform: businessPosition.femaleUniform,\n      shiftWage: businessPosition.shiftWage,\n    })),\n  };\n\n  async function onSubmit(newBusinessDTO: BusinessDTO) {\n    try {\n      await businessService.delete(business!.id.toString());\n      toast.success(\n        `Your changes to ${newBusinessDTO.name} were saved successfully`\n      );\n    } catch {\n      toast.error(\n        `There was a problem when saving your changes to ${business!.name}`\n      );\n    }\n  }\n\n  return (\n    <UserLayout section=\"business\">\n      <RPPermissionGuard permission=\"websiteCreateBusiness\">\n        <Container>\n          <Row>\n            <div className=\"col-12\">\n              <Link to=\"/businesses\">\n                <Icon\n                  className=\"fa-4x text-white\"\n                  style={{cursor: 'pointer'}}\n                  type=\"caret-left\"\n                />\n              </Link>\n            </div>\n          </Row>\n          <Row>\n            <MiniJumbotron>\n              <h2>Business Editor</h2>\n              <p>\n                You are making changes to <b>{business.name}</b>\n              </p>\n            </MiniJumbotron>\n          </Row>\n          <Row>\n            <div style={{width: '100%'}}>\n              <BusinessEditor\n                defaultBusiness={businessDTO}\n                onSubmit={onSubmit}\n              />\n            </div>\n          </Row>\n        </Container>\n      </RPPermissionGuard>\n    </UserLayout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}