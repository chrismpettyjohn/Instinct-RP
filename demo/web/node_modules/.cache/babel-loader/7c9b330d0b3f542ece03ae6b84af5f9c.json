{"ast":null,"code":"import _regeneratorRuntime from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{toast}from'react-toastify';import React,{useContext,useState}from'react';import{Icon,sessionContext}from'@instinct-web/core';import{politicalPartyService}from'../../../../../services/political-party';export function LeavePartyButton(_ref){var politicalParty=_ref.politicalParty,onChange=_ref.onChange;var _useContext=useContext(sessionContext),user=_useContext.user;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),spinner=_useState2[0],setSpinner=_useState2[1];var belongsToGroup=politicalParty.members.find(function(_){return _.id===user.id;});if(!belongsToGroup){return null;}if(politicalParty.founder.id===user.id){return null;}function onConfirm(){return _onConfirm.apply(this,arguments);}function _onConfirm(){_onConfirm=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!spinner){_context.next=3;break;}return _context.abrupt(\"return\");case 3:setSpinner(true);_context.next=6;return politicalPartyService.leaveByID(politicalParty.id);case 6:toast.info(\"You have left the political party, \".concat(politicalParty.name));onChange();case 8:_context.prev=8;setSpinner(false);return _context.finish(8);case 11:case\"end\":return _context.stop();}}},_callee,null,[[0,,8,11]]);}));return _onConfirm.apply(this,arguments);}var _ref2=!spinner?['sign-out-alt','Leave']:['spinner fa-spin','Leaving...'],_ref3=_slicedToArray(_ref2,2),buttonIcon=_ref3[0],buttonText=_ref3[1];return/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-outline-warning mr-4\",disabled:spinner,onClick:onConfirm},/*#__PURE__*/React.createElement(Icon,{type:buttonIcon}),buttonText);}","map":{"version":3,"sources":["/Users/chris/Projects/instinct/packages/@instinct-theme/roleplay/src/pages/government/parties/party-actions/leave-party-button/LeavePartyButton.tsx"],"names":["toast","React","useContext","useState","Icon","sessionContext","politicalPartyService","LeavePartyButton","politicalParty","onChange","user","spinner","setSpinner","belongsToGroup","members","find","_","id","founder","onConfirm","leaveByID","info","name","buttonIcon","buttonText"],"mappings":"4bAAA,OAAQA,KAAR,KAAoB,gBAApB,CACA,MAAOC,CAAAA,KAAP,EAAeC,UAAf,CAA2BC,QAA3B,KAA0C,OAA1C,CACA,OAAQC,IAAR,CAAcC,cAAd,KAAmC,oBAAnC,CAEA,OAAQC,qBAAR,KAAoC,yCAApC,CAEA,MAAO,SAASC,CAAAA,gBAAT,MAGe,IAFpBC,CAAAA,cAEoB,MAFpBA,cAEoB,CADpBC,QACoB,MADpBA,QACoB,CACpB,gBAAeP,UAAU,CAACG,cAAD,CAAzB,CAAOK,IAAP,aAAOA,IAAP,CACA,cAA8BP,QAAQ,CAAC,KAAD,CAAtC,wCAAOQ,OAAP,eAAgBC,UAAhB,eAEA,GAAMC,CAAAA,cAAc,CAAGL,cAAc,CAACM,OAAf,CAAuBC,IAAvB,CAA4B,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACC,EAAF,GAASP,IAAI,CAAEO,EAAnB,EAA7B,CAAvB,CAEA,GAAI,CAACJ,cAAL,CAAqB,CACnB,MAAO,KAAP,CACD,CAED,GAAIL,cAAc,CAACU,OAAf,CAAuBD,EAAvB,GAA8BP,IAAI,CAAEO,EAAxC,CAA4C,CAC1C,MAAO,KAAP,CACD,CAZmB,QAcLE,CAAAA,SAdK,qIAcpB,uJAEQR,OAFR,iEAGIC,UAAU,CAAC,IAAD,CAAV,CAHJ,sBAIUN,CAAAA,qBAAqB,CAACc,SAAtB,CAAgCZ,cAAc,CAACS,EAA/C,CAJV,QAKIjB,KAAK,CAACqB,IAAN,8CAAiDb,cAAc,CAACc,IAAhE,GACAb,QAAQ,GANZ,uBAQIG,UAAU,CAAC,KAAD,CAAV,CARJ,kGAdoB,4CA0BpB,UAAiC,CAACD,OAAD,CAC7B,CAAC,cAAD,CAAiB,OAAjB,CAD6B,CAE7B,CAAC,iBAAD,CAAoB,YAApB,CAFJ,+BAAOY,UAAP,UAAmBC,UAAnB,UAIA,mBACE,8BACE,SAAS,CAAC,8BADZ,CAEE,QAAQ,CAAEb,OAFZ,CAGE,OAAO,CAAEQ,SAHX,eAKE,oBAAC,IAAD,EAAM,IAAI,CAAEI,UAAZ,EALF,CAMGC,UANH,CADF,CAUD","sourcesContent":["import {toast} from 'react-toastify';\nimport React, {useContext, useState} from 'react';\nimport {Icon, sessionContext} from '@instinct-web/core';\nimport {PartyActionsProps} from '../PartyActions.types';\nimport {politicalPartyService} from '../../../../../services/political-party';\n\nexport function LeavePartyButton({\n  politicalParty,\n  onChange,\n}: PartyActionsProps) {\n  const {user} = useContext(sessionContext);\n  const [spinner, setSpinner] = useState(false);\n\n  const belongsToGroup = politicalParty.members.find(_ => _.id === user!.id);\n\n  if (!belongsToGroup) {\n    return null;\n  }\n\n  if (politicalParty.founder.id === user!.id) {\n    return null;\n  }\n\n  async function onConfirm() {\n    try {\n      if (spinner) return;\n      setSpinner(true);\n      await politicalPartyService.leaveByID(politicalParty.id);\n      toast.info(`You have left the political party, ${politicalParty.name}`);\n      onChange();\n    } finally {\n      setSpinner(false);\n    }\n  }\n\n  const [buttonIcon, buttonText] = !spinner\n    ? ['sign-out-alt', 'Leave']\n    : ['spinner fa-spin', 'Leaving...'];\n\n  return (\n    <button\n      className=\"btn btn-outline-warning mr-4\"\n      disabled={spinner}\n      onClick={onConfirm}\n    >\n      <Icon type={buttonIcon} />\n      {buttonText}\n    </button>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}