{"ast":null,"code":"import _slicedToArray from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import'./LawDirectory.scss';import{Link}from'wouter';import{uniqBy}from'lodash';import React,{useContext,useState}from'react';import{Row}from'../../../components/generic/row/Row';import{Card}from'../../../components/generic/card/Card';import{UserLayout}from'../../../components/layout/user';import{useFetchLaws}from'../../../hooks/law/fetch-laws';import{Icon,Input,Select,setURL,Avatar,configContext}from'@instinct-web/core';import{Container}from'../../../components/generic/container/Container';import{RPPermissionGuard}from'../../../components/templates/permission-guard';import{MiniJumbotron}from'../../../components/generic/mini-jumbotron/MiniJumbotron';import{getPrettyLawStatus}from'./bill.const';setURL('government/laws',/*#__PURE__*/React.createElement(LawDirectory,null));export function LawDirectory(){var _laws$map;var laws=useFetchLaws();var _useContext=useContext(configContext),config=_useContext.config;var _useState=useState(),_useState2=_slicedToArray(_useState,2),billNameFilter=_useState2[0],setBillNameFilter=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),billSponsorFilter=_useState4[0],setBillSponsorFilter=_useState4[1];function filterByName(law){if(!billNameFilter)return true;return law.id.toString().includes(billNameFilter)||law.title.toLowerCase().includes(billNameFilter)||law.description.toLowerCase().includes(billNameFilter);}function filterBySponsor(law){if(!billSponsorFilter)return true;return law.user.id===billSponsorFilter;}var uniqueSponsors=uniqBy((_laws$map=laws===null||laws===void 0?void 0:laws.map(function(_){return _.user;}))!==null&&_laws$map!==void 0?_laws$map:[],'id').map(function(_){return{value:_.id,label:_.username};});var filteredBills=laws===null||laws===void 0?void 0:laws.filter(filterByName).filter(filterBySponsor);return/*#__PURE__*/React.createElement(UserLayout,{section:\"games_ranking\"},/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(MiniJumbotron,null,/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Laws of \",config.siteName),/*#__PURE__*/React.createElement(\"p\",null,\"The following are bills submitted to the National Assembly\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 text-right\"},/*#__PURE__*/React.createElement(RPPermissionGuard,{permission:\"websiteProposeLaws\",redirect:false},/*#__PURE__*/React.createElement(Link,{to:\"/government/laws/create\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-success btn-lg\"},/*#__PURE__*/React.createElement(Icon,{type:\"plus-circle\"}),\"Propose Law\")))))))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"col-12\"},/*#__PURE__*/React.createElement(MiniJumbotron,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{className:\"col-12 mb-4\"},/*#__PURE__*/React.createElement(\"h2\",null,\"Search\")),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Bill Text\"),/*#__PURE__*/React.createElement(Input,{value:billNameFilter!==null&&billNameFilter!==void 0?billNameFilter:'',name:\"bill_filter\",placeholder:\"Search by text...\",type:\"text\",onChange:function onChange(key,value){return setBillNameFilter(value.toLowerCase());}})),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Bill Sponsor\"),/*#__PURE__*/React.createElement(Select,{options:uniqueSponsors,value:uniqueSponsors.find(function(_){return _.value===billSponsorFilter;}),onChange:function onChange(_){return setBillSponsorFilter(_.value);}})))))),/*#__PURE__*/React.createElement(Row,null,laws===undefined&&/*#__PURE__*/React.createElement(\"div\",{className:\"text-center\",style:{color:'white'}},/*#__PURE__*/React.createElement(Icon,{type:\"spin\",className:\"fa-spin\"}),/*#__PURE__*/React.createElement(\"h4\",null,\"Fetching bills...\")),filteredBills===null||filteredBills===void 0?void 0:filteredBills.map(function(bill){return/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 mb-2\",key:\"bill_\".concat(bill.id)},/*#__PURE__*/React.createElement(Card,{className:\"law-card\",header:/*#__PURE__*/React.createElement(Link,{to:\"/government/laws/view/\".concat(bill.id)},\"A-\",bill.id,\": \",bill.title)},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"member-container\"},/*#__PURE__*/React.createElement(\"div\",{className:\"member-content\"},/*#__PURE__*/React.createElement(\"div\",{className:\"member-avatar flex-container flex-vertical-center flex-horizontal-center\",style:{overflow:'hidden'}},/*#__PURE__*/React.createElement(Avatar,{look:bill.user.figure})))),/*#__PURE__*/React.createElement(\"div\",{className:\"ml-4\"},/*#__PURE__*/React.createElement(\"h4\",null,\"Type: \",/*#__PURE__*/React.createElement(\"b\",null,\"General Bill\"),' '),/*#__PURE__*/React.createElement(\"h4\",null,\"Proposed By: \",/*#__PURE__*/React.createElement(\"b\",null,bill.user.username)),/*#__PURE__*/React.createElement(\"h4\",null,\"Status: \",/*#__PURE__*/React.createElement(\"b\",null,getPrettyLawStatus(bill.status)))))));}))));}","map":{"version":3,"sources":["/Users/chris/Projects/instinct/packages/@instinct-theme/roleplay/src/pages/government/laws/LawDirectory.tsx"],"names":["Link","uniqBy","React","useContext","useState","Row","Card","UserLayout","useFetchLaws","Icon","Input","Select","setURL","Avatar","configContext","Container","RPPermissionGuard","MiniJumbotron","getPrettyLawStatus","LawDirectory","laws","config","billNameFilter","setBillNameFilter","billSponsorFilter","setBillSponsorFilter","filterByName","law","id","toString","includes","title","toLowerCase","description","filterBySponsor","user","uniqueSponsors","map","_","value","label","username","filteredBills","filter","siteName","key","find","undefined","color","bill","overflow","figure","status"],"mappings":"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","sourcesContent":["import './LawDirectory.scss';\nimport {Link} from 'wouter';\nimport {uniqBy} from 'lodash';\nimport React, {useContext, useState} from 'react';\nimport {Law} from '@instinct-plugin/roleplay-types';\nimport {Row} from '../../../components/generic/row/Row';\nimport {Card} from '../../../components/generic/card/Card';\nimport {UserLayout} from '../../../components/layout/user';\nimport {useFetchLaws} from '../../../hooks/law/fetch-laws';\nimport {\n  Icon,\n  Input,\n  Select,\n  setURL,\n  Avatar,\n  configContext,\n} from '@instinct-web/core';\nimport {Container} from '../../../components/generic/container/Container';\nimport {RPPermissionGuard} from '../../../components/templates/permission-guard';\nimport {MiniJumbotron} from '../../../components/generic/mini-jumbotron/MiniJumbotron';\nimport {getPrettyLawStatus} from './bill.const';\n\nsetURL('government/laws', <LawDirectory />);\n\nexport function LawDirectory() {\n  const laws = useFetchLaws();\n  const {config} = useContext(configContext);\n  const [billNameFilter, setBillNameFilter] = useState<string>();\n  const [billSponsorFilter, setBillSponsorFilter] = useState<number>();\n\n  function filterByName(law: Law): boolean {\n    if (!billNameFilter) return true;\n    return (\n      law.id.toString().includes(billNameFilter) ||\n      law.title.toLowerCase().includes(billNameFilter) ||\n      law.description.toLowerCase().includes(billNameFilter)\n    );\n  }\n\n  function filterBySponsor(law: Law): boolean {\n    if (!billSponsorFilter) return true;\n    return law.user.id === billSponsorFilter;\n  }\n\n  const uniqueSponsors = uniqBy(laws?.map(_ => _.user) ?? [], 'id').map(_ => ({\n    value: _.id,\n    label: _.username,\n  }));\n\n  const filteredBills = laws?.filter(filterByName).filter(filterBySponsor);\n\n  return (\n    <UserLayout section=\"games_ranking\">\n      <Container>\n        <Row>\n          <div className=\"col-12\">\n            <MiniJumbotron>\n              <div className=\"row\">\n                <div className=\"col-6\">\n                  <h1>Laws of {config.siteName}</h1>\n                  <p>\n                    The following are bills submitted to the National Assembly\n                  </p>\n                </div>\n                <div className=\"col-6 text-right\">\n                  <RPPermissionGuard\n                    permission=\"websiteProposeLaws\"\n                    redirect={false}\n                  >\n                    <Link to=\"/government/laws/create\">\n                      <button className=\"btn btn-success btn-lg\">\n                        <Icon type=\"plus-circle\" />\n                        Propose Law\n                      </button>\n                    </Link>\n                  </RPPermissionGuard>\n                </div>\n              </div>\n            </MiniJumbotron>\n          </div>\n        </Row>\n        <Row>\n          <div className=\"col-12\">\n            <MiniJumbotron>\n              <Row>\n                <div className=\"col-12 mb-4\">\n                  <h2>Search</h2>\n                </div>\n                <div className=\"col-6\">\n                  <h4>Bill Text</h4>\n                  <Input\n                    value={billNameFilter ?? ''}\n                    name=\"bill_filter\"\n                    placeholder=\"Search by text...\"\n                    type=\"text\"\n                    onChange={(key, value) =>\n                      setBillNameFilter(value.toLowerCase())\n                    }\n                  />\n                </div>\n                <div className=\"col-6\">\n                  <h4>Bill Sponsor</h4>\n                  <Select\n                    options={uniqueSponsors}\n                    value={uniqueSponsors.find(\n                      _ => _.value === billSponsorFilter\n                    )}\n                    onChange={(_: any) => setBillSponsorFilter(_.value)}\n                  />\n                </div>\n              </Row>\n            </MiniJumbotron>\n          </div>\n        </Row>\n        <Row>\n          {laws === undefined && (\n            <div className=\"text-center\" style={{color: 'white'}}>\n              <Icon type=\"spin\" className=\"fa-spin\" />\n              <h4>Fetching bills...</h4>\n            </div>\n          )}\n          {filteredBills?.map(bill => (\n            <div className=\"col-6 mb-2\" key={`bill_${bill.id}`}>\n              <Card\n                className=\"law-card\"\n                header={\n                  <Link to={`/government/laws/view/${bill.id}`}>\n                    A-{bill.id}: {bill.title}\n                  </Link>\n                }\n              >\n                <div className=\"d-flex\">\n                  <div className=\"member-container\">\n                    <div className=\"member-content\">\n                      <div\n                        className=\"member-avatar flex-container flex-vertical-center flex-horizontal-center\"\n                        style={{overflow: 'hidden'}}\n                      >\n                        <Avatar look={bill.user.figure} />\n                      </div>\n                    </div>\n                  </div>\n                  <div className=\"ml-4\">\n                    <h4>\n                      Type: <b>General Bill</b>{' '}\n                    </h4>\n                    <h4>\n                      Proposed By: <b>{bill.user.username}</b>\n                    </h4>\n                    <h4>\n                      Status: <b>{getPrettyLawStatus(bill.status)}</b>\n                    </h4>\n                  </div>\n                </div>\n              </Card>\n            </div>\n          ))}\n        </Row>\n      </Container>\n    </UserLayout>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}