{"ast":null,"code":"import _toConsumableArray from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/chris/Projects/instinct/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Link}from'wouter';import Moment from'moment';import{DeletePostModal}from'./delete-post-modal';import React,{useEffect,useState}from'react';import{Card}from'../../../../components/generic/card/Card';import{CreatePostModal}from'./create-post-modal/CreatePostModal';import{Avatar,guestbookService,Icon}from'@instinct-web/core';export function Guestbook(_ref){var _profile$user;var profile=_ref.profile;var _useState=useState(),_useState2=_slicedToArray(_useState,2),comments=_useState2[0],setComments=_useState2[1];useEffect(function(){function fetchGuestbook(){return _fetchGuestbook.apply(this,arguments);}function _fetchGuestbook(){_fetchGuestbook=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setComments(undefined);_context.next=3;return guestbookService.getAllForUser(profile.user.id);case 3:data=_context.sent;setComments(data);case 5:case\"end\":return _context.stop();}}},_callee);}));return _fetchGuestbook.apply(this,arguments);}fetchGuestbook();},[profile===null||profile===void 0?void 0:(_profile$user=profile.user)===null||_profile$user===void 0?void 0:_profile$user.id]);function onPostCreated(post){setComments(function(_){return[].concat(_toConsumableArray(_),[post]);});}function onPostDeleted(postID){setComments(function(_){return _.filter(function(p){return p.id!==postID;});});}function getHeader(){return/*#__PURE__*/React.createElement(\"div\",{className:\"row\"},/*#__PURE__*/React.createElement(\"div\",{className:\"col-6\"},\"Guestbook\"),/*#__PURE__*/React.createElement(\"div\",{className:\"col-6 text-right\"},/*#__PURE__*/React.createElement(CreatePostModal,{profileID:profile.user.id,onCreation:onPostCreated})));}return/*#__PURE__*/React.createElement(Card,{header:getHeader()},/*#__PURE__*/React.createElement(\"div\",{style:{maxHeight:500,overflowY:'scroll',overflowX:'hidden'}},!comments&&/*#__PURE__*/React.createElement(Icon,{className:\"fa-spin\",type:\"spinner\"}),(comments===null||comments===void 0?void 0:comments.length)===0&&/*#__PURE__*/React.createElement(\"p\",null,\"There aren't any comments to display.\"),comments===null||comments===void 0?void 0:comments.map(function(_){return/*#__PURE__*/React.createElement(\"div\",{className:\"row\",key:_.id},/*#__PURE__*/React.createElement(Avatar,{look:_.author.figure,headOnly:true}),/*#__PURE__*/React.createElement(\"div\",{style:{marginTop:20}},/*#__PURE__*/React.createElement(\"h5\",null,_.content),/*#__PURE__*/React.createElement(\"div\",{className:\"d-inline\"},\"Posted by\",' ',/*#__PURE__*/React.createElement(Link,{to:\"/profile/\".concat(_.author.username)},/*#__PURE__*/React.createElement(\"b\",{style:{cursor:'pointer'}},_.author.username)),\", \",Moment.unix(_.timestamp).fromNow(),/*#__PURE__*/React.createElement(DeletePostModal,{post:_,onDeletion:function onDeletion(){return onPostDeleted(_.id);}}))));})));}","map":{"version":3,"sources":["/Users/chris/Projects/instinct/packages/@instinct-theme/roleplay/src/pages/home/user-profile/guestbook/Guestbook.tsx"],"names":["Link","Moment","DeletePostModal","React","useEffect","useState","Card","CreatePostModal","Avatar","guestbookService","Icon","Guestbook","profile","comments","setComments","fetchGuestbook","undefined","getAllForUser","user","id","data","onPostCreated","post","_","onPostDeleted","postID","filter","p","getHeader","maxHeight","overflowY","overflowX","length","map","author","figure","marginTop","content","username","cursor","unix","timestamp","fromNow"],"mappings":"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","sourcesContent":["import {Link} from 'wouter';\nimport Moment from 'moment';\nimport {DeletePostModal} from './delete-post-modal';\nimport React, {useEffect, useState} from 'react';\nimport {UserGuestbookPost} from '@instinct-prj/interface';\nimport {UserProfileWidgetProps} from '../UserProfile.types';\nimport {Card} from '../../../../components/generic/card/Card';\nimport {CreatePostModal} from './create-post-modal/CreatePostModal';\nimport {Avatar, guestbookService, Icon} from '@instinct-web/core';\n\nexport function Guestbook({profile}: UserProfileWidgetProps) {\n  const [comments, setComments] = useState<UserGuestbookPost[]>();\n\n  useEffect(() => {\n    async function fetchGuestbook() {\n      setComments(undefined);\n      const data = await guestbookService.getAllForUser(profile!.user.id);\n      setComments(data);\n    }\n    fetchGuestbook();\n  }, [profile?.user?.id]);\n\n  function onPostCreated(post: UserGuestbookPost) {\n    setComments(_ => [..._!, post]);\n  }\n\n  function onPostDeleted(postID: number) {\n    setComments(_ => _!.filter(p => p.id !== postID));\n  }\n\n  function getHeader() {\n    return (\n      <div className=\"row\">\n        <div className=\"col-6\">Guestbook</div>\n        <div className=\"col-6 text-right\">\n          <CreatePostModal\n            profileID={profile!.user!.id}\n            onCreation={onPostCreated}\n          />\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <Card header={getHeader()}>\n      <div style={{maxHeight: 500, overflowY: 'scroll', overflowX: 'hidden'}}>\n        {!comments && <Icon className=\"fa-spin\" type=\"spinner\" />}\n        {comments?.length === 0 && <p>There aren't any comments to display.</p>}\n        {comments?.map(_ => (\n          <div className=\"row\" key={_.id}>\n            <Avatar look={_.author.figure} headOnly />\n            <div style={{marginTop: 20}}>\n              <h5>{_.content}</h5>\n              <div className=\"d-inline\">\n                Posted by{' '}\n                <Link to={`/profile/${_.author.username}`}>\n                  <b style={{cursor: 'pointer'}}>{_.author.username}</b>\n                </Link>\n                , {Moment.unix(_.timestamp).fromNow()}\n                <DeletePostModal\n                  post={_}\n                  onDeletion={() => onPostDeleted(_.id)}\n                />\n              </div>\n            </div>\n          </div>\n        ))}\n      </div>\n    </Card>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}